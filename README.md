**Author**: Felipe Tarijon  
**Started**: 01/18/2021
  
## What is this?
Apymonitor is a python tool to create an APIMonitor xml filter output file based on a PE import list, ready to use to analyze an artifact.
  
## Usage
```code:bash
python apymonitor.py -i malware.exe -o output.xml
```
It will output into the file something like this:  
```code:xml
<?xml version="1.0"?>
<!--
API Monitor Filter
(c) 2010-2013, Rohitab Batra <rohitab@rohitab.com>
http://www.rohitab.com/apimonitor/
-
This document was generated by Apymonitor.
2021-03-13 16:36:33 UTC
A python project which generates a valid APIMonitor XML document with a PE as input.
More info: github.com/felipetarijon/apymonitor
-->
<ApiMonitor>
	<CaptureFilter>
		<Module Name="KERNEL32.dll">
			<Api Name="VirtualAlloc"/>
			<Api Name="VirtualFree"/>
			<Api Name="CreateFileA"/>
			<Api Name="GetFileSize"/>
			<Api Name="ReadFile"/>
			<Api Name="WriteFile"/>
			<Api Name="CloseHandle"/>
			<Api Name="MapViewOfFile"/>
        </Module>
	</CaptureFilter>
</ApiMonitor>
```

## Cloning and getting ready:
```code:bash
git clone git@github.com:felipetarijon/apymonitor.git
python3.6 -m venv env
source env/bin/activate
pip install -r requirements.txt
python apymonitor.py
```
  
## Build:
```code:bash
pyinstaller apymonitor.py
./dist/apymonitor/apymonitor -h
```
  
## To do:  
* [ ] Replace the XML lib (xml.dom.minidom) by another more secure  
* [x] Implement argparse  
* [x] Build an executable file to be used as a tool  
* [ ] Add more arguments/options to:  
    * [x] allow change xml output filename  
    * [x] generate the xml without the extra_header (non-default option)  
    * [ ] blacklist some api function or dll
  
## Changelog:  
* 01/19/2021:  
    * Added pyinstaller package to build executable files.  
    * Implemented argparse.
* 03/13/2021:  
    * Fixed the argparse to show help message when user provide no args.
    * Added the option to not output the extra_header.